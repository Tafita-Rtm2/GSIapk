(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2],{27541:(e,s,t)=>{Promise.resolve().then(t.bind(t,58349))},34818:(e,s,t)=>{"use strict";t.d(s,{z:()=>n});var i=t(95155),r=t(51190),l=t(20063),a=t(64269);function n(e){let{title:s,subtitle:t,onBack:n,rightElement:d,className:c}=e,o=(0,l.useRouter)();return(0,i.jsxs)("div",{className:(0,a.cn)("flex items-center justify-between mb-6 gap-4",c),children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("button",{onClick:()=>{n?n():o.back()},className:"p-2 bg-gray-100 rounded-xl text-gray-500 hover:bg-gray-200 active:scale-90 transition-all",children:(0,i.jsx)(r.A,{size:24})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-xl font-bold text-gray-800 leading-tight",children:s}),t&&(0,i.jsx)("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:t})]})]}),d&&(0,i.jsx)("div",{children:d})]})}},58349:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var i=t(95155),r=t(96149),l=t(52910),a=t(90109),n=t(63263),d=t(77187),c=t(5225),o=t(50984),x=t(53489),u=t(82111),g=t(18274),m=t(59828),p=t(64269),h=t(34818),f=t(12115),b=t(68497),v=t(18720);function j(){let{t:e}=(0,l.o)(),[s,t]=(0,f.useState)([]),[j,N]=(0,f.useState)(null),[y,w]=(0,f.useState)([]),[k,B]=(0,f.useState)([]),[P,S]=(0,f.useState)(null);(0,f.useEffect)(()=>{let e=b.B.getCurrentUser();if(!e)return;let s=b.B.subscribeLessons({niveau:e.niveau},s=>{let i=s.filter(s=>s.filiere.includes(e.filiere)||0===s.filiere.length);w(i),t(Array.from(new Set(i.map(e=>e.subject))).map((e,s)=>{let t=i.filter(s=>s.subject===e),r=t.length,l=t.reduce((e,s)=>{var t;return e+((null==(t=b.B.getProgress(s.id))?void 0:t.percent)||0)},0);return{id:s,title:e,progress:r>0?Math.round(l/r):0,icon:"\uD83D\uDCD6",color:"bg-indigo-500",items:r}}))}),i=b.B.subscribeAssignments({niveau:e.niveau},s=>{B(s.filter(s=>s.filiere.includes(e.filiere)||0===s.filiere.length))}),r=()=>{b.B.getLessons().then(e=>{let s=b.B.getCurrentUser();s&&w([...e.filter(e=>(e.filiere.includes(s.filiere)||0===e.filiere.length)&&e.niveau===s.niveau)])})};return window.addEventListener("gsi_progress_updated",r),()=>{s(),i(),window.removeEventListener("gsi_progress_updated",r)}},[]);let z=y.filter(e=>e.subject===j),A=k.filter(e=>e.subject===j);return(0,i.jsx)(r.e,{children:(0,i.jsxs)("div",{className:"p-6 pb-24 bg-[#F8FAFC] min-h-full",children:[(0,i.jsx)(h.z,{title:j||e("matieres"),onBack:j?()=>N(null):void 0}),j?(0,i.jsxs)("div",{className:"space-y-8 animate-in slide-in-from-right-4 duration-300",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-400 mb-4 ml-2",children:"Le\xe7ons & Supports"}),(0,i.jsxs)("div",{className:"space-y-3",children:[z.map(e=>{var s,t,r,l;return(0,i.jsxs)("div",{className:"bg-white p-4 rounded-[28px] border border-gray-100 shadow-sm flex items-center gap-4",children:[(0,i.jsx)("div",{className:"w-12 h-12 bg-indigo-50 rounded-2xl flex items-center justify-center text-indigo-600",children:(0,i.jsx)(c.A,{size:20})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("h4",{className:"font-bold text-xs uppercase tracking-tight",children:e.title}),(null==(s=b.B.getProgress(e.id))?void 0:s.completed)&&(0,i.jsx)(o.A,{size:12,className:"text-emerald-500"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("p",{className:"text-[10px] text-gray-400 font-medium",children:[new Date(e.date).toLocaleDateString(),(null==(t=b.B.getProgress(e.id))?void 0:t.currentPage)&&" â€¢ Page ".concat(b.B.getProgress(e.id).currentPage)]}),(null==(r=b.B.getProgress(e.id))?void 0:r.percent)!==void 0&&(0,i.jsxs)("span",{className:"text-[9px] font-black text-indigo-500",children:[b.B.getProgress(e.id).percent,"%"]})]}),(null==(l=b.B.getProgress(e.id))?void 0:l.percent)!==void 0&&(0,i.jsx)("div",{className:"w-full h-1 bg-gray-100 rounded-full mt-1.5 overflow-hidden",children:(0,i.jsx)("div",{className:"h-full bg-indigo-500 transition-all duration-700",style:{width:"".concat(b.B.getProgress(e.id).percent,"%")}})})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:()=>{var s;return(null==(s=e.files)?void 0:s[0])&&b.B.downloadPackFile(e.files[0],e.title,e.id)},className:(0,p.cn)("p-3 rounded-xl transition-all",b.B.isDownloaded(e.id)?"bg-emerald-100 text-emerald-600":"bg-gray-50 text-gray-400"),children:(0,i.jsx)(x.A,{size:16})}),(0,i.jsx)("button",{onClick:()=>{var s;return(null==(s=e.files)?void 0:s[0])&&b.B.openPackFile(e.id,e.files[0])},className:"p-3 bg-indigo-600 text-white rounded-xl shadow-lg shadow-indigo-100",children:(0,i.jsx)(u.A,{size:16})})]})]},e.id)}),0===z.length&&(0,i.jsx)("p",{className:"text-[10px] font-bold text-gray-300 uppercase ml-4",children:"Pas de le\xe7ons"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-400 mb-4 ml-2",children:"Devoirs \xe0 rendre"}),(0,i.jsxs)("div",{className:"space-y-3",children:[A.map(e=>{var s;return(0,i.jsxs)("div",{className:"bg-white p-5 rounded-[32px] border border-gray-100 shadow-sm",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsxs)("span",{className:"bg-orange-50 text-orange-600 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest",children:["\xc9ch\xe9ance : ",e.deadline]}),(0,i.jsx)(g.A,{size:16,className:"text-orange-400"})]}),(0,i.jsx)("h4",{className:"font-black text-xs uppercase tracking-tight mb-4",children:e.title}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(null==(s=e.files)?void 0:s[0])&&(0,i.jsx)("button",{onClick:()=>b.B.openPackFile(e.id,e.files[0]),className:"flex-1 py-3 bg-gray-50 text-gray-600 rounded-xl text-[9px] font-black uppercase tracking-widest",children:"Consulter"}),(0,i.jsx)("button",{disabled:P===e.id,onClick:()=>{let s=confirm("Voulez-vous envoyer un FICHIER (OK) ou du TEXTE (Annuler) ?"),t=b.B.getCurrentUser();if(!t)return v.o.error("Veuillez vous reconnecter.");if(s){let s=document.createElement("input");s.type="file",s.onchange=async s=>{let i=s.target.files[0];if(!i)return;S(e.id);let r=v.o.loading('T\xe9l\xe9versement de "'.concat(i.name,'"...'));try{let s=await b.B.uploadFile(i,"submissions/".concat(e.id,"_").concat(t.id,"_").concat(i.name));await b.B.addSubmission({id:Math.random().toString(36).substr(2,9),assignmentId:e.id,studentId:t.id,studentName:t.fullName,date:new Date().toISOString(),file:s,campus:t.campus,filiere:t.filiere,niveau:t.niveau}),v.o.success("Devoir envoy\xe9 avec succ\xe8s !",{id:r})}catch(e){v.o.error("\xc9chec de l'envoi : "+e.message,{id:r})}finally{S(null)}},s.click()}else{let s=prompt("Entrez votre r\xe9ponse :");s&&(S(e.id),b.B.addSubmission({id:Math.random().toString(36).substr(2,9),assignmentId:e.id,studentId:t.id,studentName:t.fullName,date:new Date().toISOString(),file:s}).then(()=>{v.o.success("R\xe9ponse envoy\xe9e !"),S(null)}))}},className:(0,p.cn)("flex-1 py-3 bg-indigo-600 text-white rounded-xl text-[9px] font-black uppercase tracking-widest shadow-lg shadow-indigo-100 disabled:opacity-50 disabled:animate-pulse",P===e.id&&"bg-indigo-400"),children:P===e.id?"Envoi...":"D\xe9poser"})]})]},e.id)}),0===A.length&&(0,i.jsx)("p",{className:"text-[10px] font-bold text-gray-300 uppercase ml-4",children:"Pas de devoirs"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-gray-400 mb-4 ml-2",children:"Cours Vid\xe9o"}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-4",children:(0,i.jsxs)("div",{className:"bg-white p-4 rounded-[32px] border border-gray-100 shadow-sm opacity-40",children:[(0,i.jsx)("div",{className:"aspect-video bg-gray-100 rounded-2xl mb-3 flex items-center justify-center",children:(0,i.jsx)(m.A,{size:24,className:"text-gray-300"})}),(0,i.jsx)("p",{className:"text-[10px] font-black uppercase text-center",children:"Bient\xf4t disponible"})]})})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"relative mb-8",children:[(0,i.jsx)(a.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,i.jsx)("input",{type:"text",placeholder:"Rechercher une mati\xe8re...",className:"w-full bg-white border border-gray-100 rounded-2xl py-4 pl-12 pr-4 outline-none text-sm shadow-sm focus:ring-2 ring-indigo-500/10 transition-all"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[s.map(e=>(0,i.jsxs)("div",{onClick:()=>N(e.title),className:"bg-white p-5 rounded-[32px] shadow-sm border border-gray-100 flex items-center gap-4 hover:shadow-md transition-all cursor-pointer group",children:[(0,i.jsx)("div",{className:"w-14 h-14 bg-indigo-50 rounded-2xl flex items-center justify-center text-2xl text-indigo-600 group-hover:bg-indigo-600 group-hover:text-white transition-all",children:e.icon}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,i.jsx)("h4",{className:"font-black text-gray-900 text-sm uppercase tracking-tight",children:e.title}),(0,i.jsxs)("span",{className:"text-[10px] font-black text-indigo-600",children:[e.progress,"%"]})]}),(0,i.jsx)("div",{className:"w-full h-1.5 bg-gray-100 rounded-full overflow-hidden",children:(0,i.jsx)("div",{className:"h-full bg-indigo-600 transition-all duration-1000",style:{width:"".concat(e.progress,"%")}})}),(0,i.jsxs)("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-2",children:[e.items," Ressources"]})]}),(0,i.jsx)(n.A,{size:20,className:"text-gray-300"})]},e.id)),0===s.length&&(0,i.jsxs)("div",{className:"text-center py-20 opacity-20",children:[(0,i.jsx)(d.A,{size:48,className:"mx-auto mb-4"}),(0,i.jsx)("p",{className:"text-xs font-black uppercase",children:"Aucune mati\xe8re trouv\xe9e"})]})]})]})]})})}}},e=>{e.O(0,[233,909,619,674,497,530,441,493,358],()=>e(e.s=27541)),_N_E=e.O()}]);