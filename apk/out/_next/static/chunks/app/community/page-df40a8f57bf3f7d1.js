(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{47069:(e,t,a)=>{Promise.resolve().then(a.bind(a,24649))},77711:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var s=a(21956),l=a.n(s)},21956:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let s=a(60306)._(a(30580));function l(e,t){var a;let l={};"function"==typeof e&&(l.loader=e);let r={...l,...t};return(0,s.default)({...r,modules:null==(a=r.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},39827:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return l}});let s=a(93719);function l(e){let{reason:t,children:a}=e;if("undefined"==typeof window)throw new s.BailoutToCSRError(t);return a}},30580:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let s=a(95155),l=a(12115),r=a(39827),n=a(79214);function i(e){return{default:e&&"default"in e?e.default:e}}let d={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let t={...d,...e},a=(0,l.lazy)(()=>t.loader().then(i)),o=t.loading;function c(e){let i=o?(0,s.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,d=!t.ssr||!!t.loading,c=d?l.Suspense:l.Fragment,u=t.ssr?(0,s.jsxs)(s.Fragment,{children:["undefined"==typeof window?(0,s.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,s.jsx)(a,{...e})]}):(0,s.jsx)(r.BailoutToCSR,{reason:"next/dynamic",children:(0,s.jsx)(a,{...e})});return(0,s.jsx)(c,{...d?{fallback:i}:{},children:u})}return c.displayName="LoadableComponent",c}},79214:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return i}});let s=a(95155),l=a(47650),r=a(75861),n=a(18284);function i(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let a=r.workAsyncStorage.getStore();if(void 0===a)return null;let i=[];if(a.reactLoadableManifest&&t){let e=a.reactLoadableManifest;for(let a of t){if(!e[a])continue;let t=e[a].files;i.push(...t)}}return 0===i.length?null:(0,s.jsx)(s.Fragment,{children:i.map(e=>{let t=a.assetPrefix+"/_next/"+(0,n.encodeURIPath)(e);return e.endsWith(".css")?(0,s.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,l.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},24649:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(95155),l=a(75951),r=a(90272),n=a(50437),i=a(14057);let d=(0,i.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),o=(0,i.A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);var c=a(689);let u=(0,i.A)("Paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]);var p=a(29609),x=a(12115),h=a(63699),f=a(21567),m=a(49220);function y(){let{t:e}=(0,r.o)(),[t,a]=(0,x.useState)(null),[i,y]=(0,x.useState)([]),[g,b]=(0,x.useState)([]),[k,v]=(0,x.useState)(""),[j,w]=(0,x.useState)(null),N=(0,x.useRef)(null);(0,x.useEffect)(()=>{a(h.B.getCurrentUser());let e=h.B.subscribeMessages(e=>{b(e),setTimeout(()=>{N.current&&(N.current.scrollTop=N.current.scrollHeight)},100)}),t=h.B.subscribeUsers(e=>y(e));return()=>{e(),t()}},[]);let M=e=>{let t=i.find(t=>t.id===e.senderId),a=(null==t?void 0:t.photo)||e.senderPhoto;return h.B.getMediaUrl(a)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(e.senderName)},A=async e=>{if(e.preventDefault(),!k.trim())return;let t=k.trim(),a=j?{senderName:j.senderName,text:j.text}:void 0;v(""),w(null),await h.B.sendMessage(t,a)};return t?(0,s.jsx)(l.e,{children:(0,s.jsxs)("div",{className:"flex flex-col h-full bg-[#F8FAFC]",children:[(0,s.jsxs)("div",{className:"p-6 bg-white border-b border-gray-100 flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-black text-gray-900 uppercase tracking-tight",children:"Communaut\xe9"}),(0,s.jsxs)("p",{className:"text-[9px] font-bold text-indigo-500 uppercase tracking-widest",children:[t.filiere," â€¢ ",t.niveau]})]}),(0,s.jsxs)("div",{className:"bg-indigo-50 px-3 py-1 rounded-full flex items-center gap-2",children:[(0,s.jsx)(n.A,{size:12,className:"text-indigo-600"}),(0,s.jsx)("span",{className:"text-[10px] font-black text-indigo-600",children:"En ligne"})]})]}),(0,s.jsxs)("div",{ref:N,className:"flex-1 overflow-y-auto p-6 space-y-6",children:[g.map((e,a)=>(0,s.jsxs)("div",{className:(0,f.cn)("flex gap-3 animate-in fade-in slide-in-from-bottom-2",e.senderId===t.id?"flex-row-reverse":"flex-row"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-indigo-50 border-2 border-white shadow-sm flex-shrink-0 overflow-hidden flex items-center justify-center",children:(0,s.jsx)("img",{src:M(e),alt:"",className:"w-full h-full object-cover",onError:t=>{t.target.onerror=null,t.target.src="https://api.dicebear.com/7.x/initials/svg?seed=".concat(e.senderName)}})}),(0,s.jsxs)("div",{className:(0,f.cn)("flex flex-col max-w-[75%]",e.senderId===t.id?"items-end":"items-start"),children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1 px-1",children:[e.senderId!==t.id&&(0,s.jsx)("span",{className:"text-[9px] font-black text-gray-400 uppercase",children:e.senderName}),(0,s.jsx)("span",{className:"text-[7px] text-gray-300 font-bold",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),(0,s.jsxs)("div",{onContextMenu:t=>{t.preventDefault(),w(e)},onClick:()=>w(e),className:(0,f.cn)("p-4 rounded-[24px] text-sm font-medium shadow-sm active:scale-[0.98] transition-transform overflow-hidden",e.senderId===t.id?"bg-indigo-600 text-white rounded-tr-none shadow-indigo-100":"bg-white text-gray-800 rounded-tl-none border border-gray-100"),children:[e.replyTo&&(0,s.jsxs)("div",{className:(0,f.cn)("mb-2 p-2 rounded-xl text-[10px] border-l-4",e.senderId===t.id?"bg-white/10 border-white/30 text-white/80":"bg-gray-50 border-indigo-500 text-gray-500"),children:[(0,s.jsx)("span",{className:"font-black block uppercase tracking-tighter opacity-50",children:e.replyTo.senderName}),(0,s.jsx)("p",{className:"line-clamp-1",children:e.replyTo.text})]}),e.text.startsWith("\uD83D\uDCF7 Photo:")?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("img",{src:h.B.getMediaUrl(e.text.split(": ")[1]),alt:"Chat attachment",className:"rounded-xl max-w-full h-auto"}),(0,s.jsx)("p",{className:"text-[10px] opacity-70",children:"Cliquer pour agrandir"})]}):e.text.startsWith("\uD83D\uDCC4 Document:")?(0,s.jsxs)("a",{href:h.B.getMediaUrl(e.text.split(": ")[1]),target:"_blank",className:"flex items-center gap-2 underline decoration-white/30",children:[(0,s.jsx)(d,{size:16})," Document joint"]}):(0,s.jsx)("div",{className:"prose prose-sm prose-invert max-w-none prose-p:my-0 prose-headings:text-sm prose-headings:my-1",children:(0,s.jsx)(m.oz,{children:e.text})})]})]})]},a)),0===g.length&&(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full opacity-20",children:[(0,s.jsx)(o,{size:48,className:"mb-4"}),(0,s.jsx)("p",{className:"text-xs font-black uppercase",children:"Aucun message"})]})]}),(0,s.jsxs)("div",{className:"p-4 bg-white border-t border-gray-100",children:[j&&(0,s.jsxs)("div",{className:"mb-2 p-3 bg-gray-50 rounded-2xl flex items-center justify-between border border-gray-100 animate-in slide-in-from-bottom-1",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)("span",{className:"text-[8px] font-black text-indigo-600 uppercase",children:["En r\xe9ponse \xe0 ",j.senderName]}),(0,s.jsx)("p",{className:"text-[10px] text-gray-400 truncate max-w-[200px]",children:j.text})]}),(0,s.jsx)("button",{onClick:()=>w(null),className:"p-1 text-gray-400",children:(0,s.jsx)(c.A,{size:14})})]}),(0,s.jsxs)("form",{onSubmit:A,className:"flex gap-2 items-end",children:[(0,s.jsx)("div",{className:"flex flex-col gap-2",children:(0,s.jsx)("button",{type:"button",onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*,application/pdf",e.onchange=async e=>{var a;let s=null===(a=e.target.files)||void 0===a?void 0:a[0];if(s){let e=await h.B.uploadFile(s,"chat/".concat(t.id,"_").concat(Date.now())),a=s.type.startsWith("image/")?"\uD83D\uDCF7 Photo":"\uD83D\uDCC4 Document";await h.B.sendMessage("".concat(a,": ").concat(e))}},e.click()},className:"p-3 bg-gray-50 text-gray-400 rounded-2xl active:scale-95 transition-all",children:(0,s.jsx)(u,{size:20})})}),(0,s.jsx)("input",{value:k,onChange:e=>v(e.target.value),placeholder:"Discutez avec votre promo...",className:"flex-1 bg-gray-50 rounded-2xl px-5 py-4 text-sm font-medium outline-none focus:ring-2 ring-indigo-500/10 transition-all"}),(0,s.jsx)("button",{type:"submit",disabled:!k.trim(),className:"bg-indigo-600 text-white p-4 rounded-2xl shadow-lg shadow-indigo-100 active:scale-95 transition-all disabled:opacity-50",children:(0,s.jsx)(p.A,{size:20})})]})]})]})}):null}},42501:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},52897:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},87493:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},6306:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]])},48694:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]])},12472:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},50437:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},82118:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},5194:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(14057).A)("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[260,181,173,764,699,951,441,517,358],()=>t(47069)),_N_E=e.O()}]);