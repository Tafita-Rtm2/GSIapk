(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{10919:(e,s,t)=>{Promise.resolve().then(t.bind(t,79493))},79493:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>j});var i=t(95155),r=t(75951),a=t(90272),l=t(31342),o=t(89832),n=t(87081),c=t(62591),d=t(26039),u=t(37195),x=t(10503),m=t(41983),p=t(10319),g=t(42501),h=t(21567),v=t(12115),b=t(63699),f=t(30814);function j(){let{t:e}=(0,a.o)(),[s,t]=(0,v.useState)("all"),[j,w]=(0,v.useState)(""),[N,C]=(0,v.useState)([]),[k,B]=(0,v.useState)(!0),[A,z]=(0,v.useState)(!1);(0,v.useEffect)(()=>{let e=b.B.getCurrentUser(),s=b.B.getCache("library_books");s&&(C(s),B(!1));let t=(s,t)=>{let i=[...s.filter(s=>!e||"admin"===e.role||s.niveau===e.niveau&&(s.filiere.includes(e.filiere)||0===s.filiere.length)&&(s.campus.includes(e.campus)||0===s.campus.length)).map(e=>{var s;return{id:e.id,title:e.title,author:"Cours: ".concat(e.subject),type:"Le\xe7on",url:(null===(s=e.files)||void 0===s?void 0:s[0])||"",favorite:!1,downloaded:b.B.isDownloaded(e.id)}}),...t.filter(s=>!e||"admin"===e.role||s.niveau===e.niveau&&(s.filiere.includes(e.filiere)||0===s.filiere.length)&&(s.campus.includes(e.campus)||0===s.campus.length)).map(e=>{var s;return{id:e.id,title:e.title,author:"Devoir: ".concat(e.subject),type:"Devoir",url:(null===(s=e.files)||void 0===s?void 0:s[0])||"",favorite:!1,downloaded:b.B.isDownloaded(e.id)}})];C(i),b.B.setCache("library_books",i),B(!1)},i=[],r=[],a=b.B.subscribeLessons({niveau:null==e?void 0:e.niveau},e=>{t(i=e,r)}),l=b.B.subscribeAssignments({niveau:null==e?void 0:e.niveau},e=>{t(i,r=e)});return()=>{a(),l()}},[]);let D=(e,s,t)=>{if(!e)return f.o.error("Pas de fichier joint.");f.o.promise(b.B.downloadPackFile(e,t,s),{loading:'T\xe9l\xe9chargement de "'.concat(t,'"...'),success:e=>(C(e=>e.map(e=>e.id===s?{...e,downloaded:!0}:e)),"Document enregistr\xe9 hors-ligne !"),error:e=>"\xc9chec: ".concat(e.message||"Erreur inconnue")})},L=e=>{C(N.map(s=>s.id===e?{...s,favorite:!s.favorite}:s))};return(0,i.jsx)(r.e,{children:(0,i.jsxs)("div",{className:"p-6",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-2xl font-bold",children:e("biblio")}),(0,i.jsxs)("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest flex items-center gap-1",children:[(0,i.jsx)(l.A,{size:10,className:"text-green-500"})," Mode Hors-Ligne Actif"]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:()=>{z(!0),setTimeout(()=>{z(!1),f.o.success("Biblioth\xe8que synchronis\xe9e")},1500)},className:(0,h.cn)("bg-gray-100 p-2 rounded-xl text-gray-500",A&&"animate-spin"),children:(0,i.jsx)(o.A,{size:20})}),(0,i.jsx)("button",{className:"bg-gray-100 p-2 rounded-xl text-gray-500",children:(0,i.jsx)(n.A,{size:20})})]})]}),(0,i.jsxs)("div",{className:"relative mb-8",children:[(0,i.jsx)(c.A,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,i.jsx)("input",{type:"text",placeholder:"Rechercher un cours ou devoir...",value:j,onChange:e=>w(e.target.value),className:"w-full bg-gray-100 rounded-2xl py-3 pl-12 pr-4 outline-none text-sm focus:ring-2 ring-primary/20 transition-all"})]}),(0,i.jsxs)("div",{className:"flex gap-4 overflow-x-auto pb-4 mb-6 scrollbar-hide",children:[(0,i.jsx)(y,{label:"Tous",active:"all"===s,onClick:()=>t("all")}),(0,i.jsx)(y,{label:"Favoris",icon:d.A,active:"fav"===s,onClick:()=>t("fav")}),(0,i.jsx)(y,{label:"Cours",active:"cours"===s,onClick:()=>t("cours")}),(0,i.jsx)(y,{label:"Devoirs",active:"devoir"===s,onClick:()=>t("devoir")}),(0,i.jsx)(y,{label:"R\xe9cents",icon:u.A,active:"recent"===s,onClick:()=>t("recent")})]}),(0,i.jsxs)("div",{className:"bg-gradient-to-br from-indigo-600 to-violet-700 rounded-[40px] p-8 text-white mb-8 relative overflow-hidden shadow-xl",children:[(0,i.jsx)("div",{className:"absolute right-[-20px] bottom-[-20px] w-40 h-40 bg-white/10 rounded-full blur-3xl"}),(0,i.jsxs)("div",{className:"relative z-10",children:[(0,i.jsx)("span",{className:"bg-white/20 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider mb-4 inline-block",children:"Suggestion IA"}),(0,i.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Guide de R\xe9ussite GSI"}),(0,i.jsx)("p",{className:"text-xs opacity-80 mb-6 leading-relaxed",children:"Bas\xe9 sur vos cours r\xe9cents de Math\xe9matiques et Physique, nous vous recommandons ce support sp\xe9cial."}),(0,i.jsxs)("button",{className:"bg-white text-indigo-600 px-6 py-2.5 rounded-2xl text-xs font-bold flex items-center gap-2",children:["Lire maintenant",(0,i.jsx)(x.A,{size:14})]})]})]}),(0,i.jsx)("h3",{className:"text-lg font-bold mb-4",children:"cours"===s?"Mes Cours":"devoir"===s?"Mes Devoirs":"Mes documents"}),(0,i.jsxs)("div",{className:"space-y-4",children:[N.filter(e=>"fav"===s?e.favorite:"cours"===s?"Le\xe7on"===e.type:"devoir"===s?"Devoir"===e.type:"recent"!==s||b.B.getProgress(e.id)).filter(e=>e.title.toLowerCase().includes(j.toLowerCase())||e.author.toLowerCase().includes(j.toLowerCase())).map(e=>(0,i.jsxs)("div",{onClick:()=>{if(e.url){var s,t;b.B.saveProgress(e.id,{lastOpened:Date.now()});let i=(null===(s=(b.B.getCache("lessons")||[]).find(s=>s.id===e.id))||void 0===s?void 0:s.files)||(null===(t=(b.B.getCache("assignments")||[]).find(s=>s.id===e.id))||void 0===t?void 0:t.files)||[e.url];b.B.openPackFile(e.id,i)}},className:"bg-white p-4 rounded-3xl border border-gray-100 flex items-center gap-4 hover:border-primary/20 transition-all group cursor-pointer",children:[(0,i.jsx)("div",{className:"w-12 h-16 bg-gray-50 rounded-xl flex items-center justify-center border border-gray-100 group-hover:bg-primary/5 transition-colors",children:(0,i.jsx)(m.A,{className:"text-primary opacity-40",size:24})}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("h4",{className:"font-bold text-gray-800 text-sm line-clamp-1",children:e.title}),e.downloaded&&(0,i.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-green-500 shadow-[0_0_5px_rgba(34,197,94,0.5)]"})]}),(0,i.jsx)("p",{className:"text-[10px] text-gray-400 font-medium",children:e.author}),b.B.getProgress(e.id)&&(0,i.jsxs)("span",{className:"text-[8px] text-indigo-500 font-bold uppercase tracking-tighter",children:["Lu le ",new Date(b.B.getProgress(e.id).ts).toLocaleDateString()]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),L(e.id)},className:(0,h.cn)("p-2 rounded-xl transition-colors",e.favorite?"text-accent bg-accent/10":"text-gray-300 bg-gray-50"),children:(0,i.jsx)(d.A,{size:16,fill:e.favorite?"currentColor":"none"})}),e.url&&!e.url.match(/\.(mp4|mov|webm|jpg|jpeg|png|gif|webp)$/i)&&(0,i.jsx)("button",{onClick:s=>{s.stopPropagation(),D(e.url,e.id,e.title)},className:(0,h.cn)("p-2 rounded-xl transition-colors",e.downloaded?"bg-green-100 text-green-600":"bg-gray-50 text-primary hover:bg-primary/10"),children:(0,i.jsx)(p.A,{size:16})})]})]},e.id)),0===N.length&&!k&&(0,i.jsxs)("div",{className:"text-center py-10 text-gray-400",children:[(0,i.jsx)(g.A,{size:40,className:"mx-auto mb-3 opacity-20"}),(0,i.jsx)("p",{className:"text-sm",children:"Aucun document publi\xe9 pour votre niveau."})]})]})]})})}let y=(0,v.memo)(e=>{let{label:s,icon:t,active:r,onClick:a}=e;return(0,i.jsxs)("button",{onClick:a,className:(0,h.cn)("px-6 py-3 rounded-2xl text-xs font-bold flex items-center gap-2 whitespace-nowrap transition-all",r?"bg-primary text-white shadow-lg shadow-primary/20 scale-105":"bg-white text-gray-500 border border-gray-100"),children:[t&&(0,i.jsx)(t,{size:14}),s]})})}},e=>{var s=s=>e(e.s=s);e.O(0,[260,181,173,186,699,951,441,517,358],()=>s(10919)),_N_E=e.O()}]);