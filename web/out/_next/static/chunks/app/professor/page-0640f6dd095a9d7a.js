(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[272],{75120:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var a=t(95155),l=t(12115),n=t(14294);let i=(0,n.A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var r=t(50984),o=t(90644),d=t(47940),c=t(98428),u=t(77187),x=t(5225);let p=(0,n.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var m=t(1272),b=t(43633),g=t(6943),h=t(13630),f=t(85584),v=t(52910),j=t(20063),y=t(68497),N=t(18720),w=t(34818),k=t(64269),S=t(26549);function A(){let{t:e}=(0,v.o)(),s=(0,j.useRouter)(),[t,n]=(0,l.useState)("dashboard"),[A,C]=(0,l.useState)([]),[B,E]=(0,l.useState)([]),[M,D]=(0,l.useState)([]),[z,I]=(0,l.useState)([]),[L,F]=(0,l.useState)([]),[P,q]=(0,l.useState)(!1),[T,_]=(0,l.useState)(0),[G,V]=(0,l.useState)("syncing"),[O,R]=(0,l.useState)(""),[U,W]=(0,l.useState)(""),[Y,H]=(0,l.useState)("");(0,l.useEffect)(()=>{let e=y.B.getCurrentUser();if(!e||"professor"!==e.role)return void s.replace("/login");let t=[y.B.subscribeUsers(e=>{C(e.filter(e=>"student"===e.role)),V("ready")}),y.B.subscribeLessons({},e=>E(e)),y.B.subscribeAssignments({},e=>D(e)),y.B.subscribeSubmissions(void 0,e=>I(e)),y.B.subscribeAnnouncements(e=>F(e))],a=()=>V("offline"),l=()=>V("syncing");return window.addEventListener("offline",a),window.addEventListener("online",l),()=>{t.forEach(e=>e()),window.removeEventListener("offline",a),window.removeEventListener("online",l)}},[s]);let[J,K]=(0,l.useState)([]),[Q,X]=(0,l.useState)([]),Z=async e=>{e.preventDefault();let s=e.target.title.value,t=e.target.message.value,a=e.target.niveau.value;await y.B.addAnnouncement({id:Math.random().toString(36).substr(2,9),title:s,message:t,date:new Date().toISOString(),author:"Professeur",campus:Q,filiere:J,niveau:"Tous"===a?void 0:a}),N.o.success("Annonce envoy\xe9e \xe0 vos classes !"),e.target.reset(),n("dashboard")},$=async e=>{if(e.preventDefault(),0===J.length||0===Q.length)return void N.o.error("Fili\xe8re et campus obligatoires.");let s=e.target,t=s.elements.namedItem("files"),a=null==t?void 0:t.files,l=s.title.value,i=Math.random().toString(36).substr(2,9);q(!0),n("dashboard");let r=N.o.loading("Publication lanc\xe9e...");(async()=>{try{let e=[];a&&a.length>0&&(e=await Promise.all(Array.from(a).map(e=>y.B.uploadFile(e,"lessons/".concat(i,"_").concat(e.name),_)))),await y.B.addLesson({id:i,title:l,description:s.description.value,subject:s.subject.value,niveau:s.niveau.value,filiere:J,campus:Q,date:new Date().toISOString(),files:e}),N.o.success('Le\xe7on "'.concat(l,'" pr\xeate !'),{id:r})}catch(e){N.o.error("Erreur Cloud : "+e.message,{id:r})}finally{q(!1),_(0)}})()},ee=async e=>{e.preventDefault();let s=e.target,t=s.elements.namedItem("files"),a=null==t?void 0:t.files,l=s.title.value,i=Math.random().toString(36).substr(2,9);q(!0),n("dashboard");let r=N.o.loading("Publication du devoir...");(async()=>{try{let e=[];a&&a.length>0&&(e=await Promise.all(Array.from(a).map(e=>y.B.uploadFile(e,"assignments/".concat(i,"_").concat(e.name),_)))),await y.B.addAssignment({id:i,title:l,description:s.description.value,subject:s.subject.value,niveau:s.niveau.value,filiere:J,campus:Q,deadline:s.deadline.value,timeLimit:"23:59",maxScore:20,files:e}),N.o.success('Devoir "'.concat(l,'" disponible.'),{id:r})}catch(e){N.o.error(e.message,{id:r})}finally{q(!1),_(0)}})()};return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen max-w-md mx-auto bg-[#F8FAFC] pb-20",children:[(0,a.jsx)("div",{className:(0,k.cn)("px-6 py-2 flex items-center justify-between text-[10px] font-bold uppercase tracking-widest","ready"===G?"bg-emerald-500 text-white":"offline"===G?"bg-orange-500 text-white":"bg-violet-600 text-white animate-pulse"),children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[P?(0,a.jsx)(i,{size:12,className:"animate-spin"}):"ready"===G?(0,a.jsx)(r.A,{size:12}):(0,a.jsx)(o.A,{size:12}),(0,a.jsx)("span",{children:P?"Envoi en cours ".concat(Math.round(T),"%"):"ready"===G?"GSI Cloud : Connect\xe9":"Hors-ligne"})]})}),(0,a.jsx)("div",{className:"bg-white p-6 rounded-b-[40px] shadow-sm mb-6 border-b border-violet-100",children:(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-violet-600 rounded-2xl flex items-center justify-center text-white shadow-lg",children:(0,a.jsx)(d.A,{size:28})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-bold",children:"Prof Portal"}),(0,a.jsx)("p",{className:"text-[10px] text-gray-400 font-black uppercase",children:"GSI Internationale"})]})]}),(0,a.jsx)("button",{onClick:()=>{y.B.logout(),N.o.success("D\xe9connexion"),s.replace("/login")},className:"p-3 bg-gray-50 rounded-xl text-gray-400 active:scale-90",children:(0,a.jsx)(c.A,{size:20})})]})}),(0,a.jsxs)("div",{className:"px-6 space-y-8 flex-1 pb-10",children:["dashboard"===t&&(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:[{id:"lessons",icon:u.A,label:"Publier Le\xe7on",color:"bg-emerald-500"},{id:"assignments",icon:x.A,label:"Publier Devoir",color:"bg-orange-500"},{id:"submissions",icon:p,label:"Devoirs Re\xe7us",color:"bg-blue-500"},{id:"grades",icon:m.A,label:"Notes",color:"bg-pink-500"},{id:"announcements",icon:b.A,label:"Annonce",color:"bg-orange-600"},{id:"media",icon:u.A,label:"M\xe9diath\xe8que",color:"bg-emerald-600"},{id:"students",icon:g.A,label:"\xc9tudiants",color:"bg-indigo-500"}].map(e=>(0,a.jsxs)("button",{onClick:()=>n(e.id),className:"bg-white p-5 rounded-[32px] shadow-sm border border-gray-100 flex flex-col items-center gap-3 active:scale-95",children:[(0,a.jsx)("div",{className:"".concat(e.color," w-12 h-12 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-black/5"),children:(0,a.jsx)(e.icon,{size:24})}),(0,a.jsx)("span",{className:"text-[10px] font-black uppercase tracking-tight",children:e.label})]},e.id))}),("lessons"===t||"assignments"===t)&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(w.z,{title:"lessons"===t?"Publier Le\xe7on":"Publier Devoir",onBack:()=>n("dashboard")}),(0,a.jsxs)("form",{onSubmit:"lessons"===t?$:ee,className:"bg-white p-6 rounded-[32px] border border-gray-100 shadow-xl space-y-4",children:[(0,a.jsx)("input",{name:"subject",required:!0,className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold outline-none",placeholder:"Mati\xe8re"}),(0,a.jsx)("input",{name:"title",required:!0,className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold outline-none",placeholder:"Titre"}),(0,a.jsx)("textarea",{name:"description",required:!0,className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold outline-none min-h-[100px]",placeholder:"Description"}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-2xl space-y-3",children:[(0,a.jsx)("p",{className:"text-[10px] font-black uppercase text-gray-400",children:"Ciblage (Fili\xe8res)"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2 max-h-40 overflow-y-auto",children:S.CG.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-[10px] font-bold",children:[(0,a.jsx)("input",{type:"checkbox",checked:J.includes(e),onChange:s=>s.target.checked?K([...J,e]):K(J.filter(s=>s!==e))})," ",e]},e))})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:S.ov.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>Q.includes(e)?X(Q.filter(s=>s!==e)):X([...Q,e]),className:(0,k.cn)("p-2 rounded-xl text-[10px] font-bold transition-all",Q.includes(e)?"bg-violet-600 text-white":"bg-gray-100 text-gray-400"),children:e},e))}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("select",{name:"niveau",className:"flex-1 p-4 bg-gray-50 rounded-2xl font-bold text-xs",children:S.xY.map(e=>(0,a.jsx)("option",{children:e},e))}),"assignments"===t&&(0,a.jsx)("input",{name:"deadline",type:"date",required:!0,className:"flex-1 p-4 bg-gray-50 rounded-2xl font-bold text-xs"})]}),(0,a.jsx)("input",{name:"files",type:"file",multiple:!0,className:"w-full p-2 text-[10px]"}),(0,a.jsx)("button",{type:"submit",disabled:P,className:"w-full bg-violet-600 text-white py-5 rounded-2xl font-black uppercase shadow-lg active:scale-95",children:"Publier Maintenant"})]}),(0,a.jsxs)("div",{className:"space-y-3 mt-8",children:[(0,a.jsx)("h3",{className:"text-xs font-black uppercase tracking-widest text-gray-400 px-2",children:"lessons"===t?"Vos Le\xe7ons":"Vos Devoirs"}),("lessons"===t?B:M).map((e,s)=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-2xl border border-gray-100 flex items-center justify-between shadow-sm group",children:[(0,a.jsxs)("div",{className:"flex-1 pr-4",children:[(0,a.jsx)("h4",{className:"font-bold text-[11px] uppercase mb-1 group-hover:text-violet-600 transition-colors",children:e.title}),(0,a.jsxs)("p",{className:"text-[9px] text-gray-400 font-bold uppercase",children:[e.subject," • ",e.niveau]})]}),(0,a.jsx)("button",{onClick:async()=>{confirm("Supprimer cet \xe9l\xe9ment ?")&&("lessons"===t?await y.B.deleteLesson(e.id):await y.B.deleteAssignment(e.id),N.o.success("Supprim\xe9"))},className:"p-2 text-red-400 hover:text-red-600 bg-red-50 rounded-xl transition-all active:scale-90",children:(0,a.jsx)(h.A,{size:16})})]},s)),0===("lessons"===t?B:M).length&&(0,a.jsx)("p",{className:"text-center py-10 text-[10px] font-bold text-gray-300 uppercase italic",children:"Aucun contenu publi\xe9"})]})]}),"grades"===t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w.z,{title:"Saisie des Notes",onBack:()=>n("dashboard")}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-[32px] border border-gray-100 shadow-xl space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h3",{className:"text-sm font-bold",children:"Grille de saisie"}),(0,a.jsxs)("button",{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept=".xlsx, .xls, .csv",e.onchange=()=>{N.o.success("Fichier Excel analys\xe9. 12 notes d\xe9tect\xe9es."),A.forEach(e=>{let s=document.getElementById("grade-".concat(e.id));s&&(s.value=(Math.floor(10*Math.random())+10).toString())})},e.click()},className:"flex items-center gap-1 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-3 py-1.5 rounded-lg border border-emerald-100 active:scale-95 transition-all",children:[(0,a.jsx)(f.A,{size:14}),"Import Excel"]})]}),(0,a.jsx)("input",{id:"grade-subject",className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold",placeholder:"Mati\xe8re de l'examen"}),(0,a.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-2",children:A.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[(0,a.jsx)("span",{className:"text-xs font-bold",children:e.fullName}),(0,a.jsx)("input",{id:"grade-".concat(e.id),type:"number",className:"w-12 p-2 rounded-lg text-center font-bold",placeholder:"-",max:"20"})]},e.id))}),(0,a.jsx)("button",{onClick:async()=>{let e=document.getElementById("grade-subject").value;if(!e)return N.o.error("Mati\xe8re requise");let s=N.o.loading("Enregistrement...");for(let s of A){let t=document.getElementById("grade-".concat(s.id)).value;t&&await y.B.addGrade({id:Math.random().toString(36).substr(2,9),studentId:s.id,studentName:s.fullName,subject:e,score:parseFloat(t),maxScore:20,date:new Date().toISOString().split("T")[0],niveau:s.niveau,filiere:s.filiere})}N.o.success("Notes publi\xe9es !",{id:s}),n("dashboard")},className:"w-full bg-pink-500 text-white py-4 rounded-xl font-bold active:scale-95",children:"Valider la classe"})]})]}),"announcements"===t&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(w.z,{title:"Envoyer une Annonce",onBack:()=>n("dashboard")}),(0,a.jsxs)("form",{onSubmit:Z,className:"bg-white p-6 rounded-[32px] border border-gray-100 shadow-xl space-y-4",children:[(0,a.jsx)("input",{name:"title",required:!0,className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold outline-none",placeholder:"Titre de l'annonce"}),(0,a.jsx)("textarea",{name:"message",required:!0,className:"w-full bg-gray-50 rounded-2xl p-4 text-sm font-bold outline-none min-h-[100px]",placeholder:"Votre message aux \xe9tudiants..."}),(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-2xl space-y-3",children:[(0,a.jsx)("p",{className:"text-[10px] font-black uppercase text-gray-400",children:"Ciblage (Fili\xe8res)"}),(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2 max-h-40 overflow-y-auto",children:S.CG.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-[10px] font-bold",children:[(0,a.jsx)("input",{type:"checkbox",checked:J.includes(e),onChange:s=>s.target.checked?K([...J,e]):K(J.filter(s=>s!==e))})," ",e]},e))})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:S.ov.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>Q.includes(e)?X(Q.filter(s=>s!==e)):X([...Q,e]),className:(0,k.cn)("p-2 rounded-xl text-[10px] font-bold transition-all",Q.includes(e)?"bg-violet-600 text-white":"bg-gray-100 text-gray-400"),children:e},e))}),(0,a.jsxs)("select",{name:"niveau",className:"w-full p-4 bg-gray-50 rounded-2xl font-bold text-xs",children:[(0,a.jsx)("option",{children:"Tous"}),S.xY.map(e=>(0,a.jsx)("option",{children:e},e))]}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-orange-600 text-white py-5 rounded-2xl font-black uppercase shadow-lg active:scale-95",children:"Envoyer aux \xc9tudiants"})]})]}),"media"===t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w.z,{title:"M\xe9diath\xe8que",onBack:()=>n("dashboard")}),(0,a.jsx)("div",{className:"bg-white rounded-[32px] overflow-hidden border border-gray-100 shadow-sm h-[600px]",children:(0,a.jsx)("iframe",{src:"https://groupegsi.mg/rtmggmg/embed/gallery?category=application",width:"100%",height:"100%",frameBorder:"0"})})]}),"students"===t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w.z,{title:"Mes \xc9tudiants",onBack:()=>n("dashboard")}),A.map((e,s)=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-3xl border border-gray-100 flex items-center gap-4 shadow-sm",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-indigo-50 rounded-full flex items-center justify-center font-bold text-indigo-600 overflow-hidden",children:e.photo?(0,a.jsx)("img",{src:y.B.getAbsoluteUrl(e.photo),className:"w-full h-full object-cover",onError:s=>{s.currentTarget.src="https://api.dicebear.com/7.x/initials/svg?seed=".concat(e.fullName)}}):e.fullName.charAt(0)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-bold text-sm",children:e.fullName}),(0,a.jsxs)("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:[e.filiere," • ",e.niveau]})]})]},s))]}),"submissions"===t&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w.z,{title:"Devoirs Re\xe7us",onBack:()=>n("dashboard")}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-3xl border border-gray-100 shadow-sm space-y-3",children:[(0,a.jsx)("p",{className:"text-[10px] font-black uppercase text-gray-400",children:"Filtrer les rendus"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("select",{value:O,onChange:e=>R(e.target.value),className:"p-3 bg-gray-50 rounded-xl text-[10px] font-bold outline-none",children:[(0,a.jsx)("option",{value:"",children:"Tous les Campus"}),S.ov.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]}),(0,a.jsxs)("select",{value:Y,onChange:e=>H(e.target.value),className:"p-3 bg-gray-50 rounded-xl text-[10px] font-bold outline-none",children:[(0,a.jsx)("option",{value:"",children:"Tous les Niveaux"}),S.xY.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("select",{value:U,onChange:e=>W(e.target.value),className:"w-full p-3 bg-gray-50 rounded-xl text-[10px] font-bold outline-none",children:[(0,a.jsx)("option",{value:"",children:"Toutes les Fili\xe8res"}),S.CG.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[z.filter(e=>{let s=A.find(s=>s.id===e.studentId);return(!O||(null==s?void 0:s.campus)===O)&&(!U||(null==s?void 0:s.filiere)===U)&&(!Y||(null==s?void 0:s.niveau)===Y)}).map((e,s)=>{let t=M.find(s=>s.id===e.assignmentId);return(0,a.jsxs)("div",{className:"bg-white p-6 rounded-[32px] border border-gray-100 shadow-sm space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-black text-xs uppercase text-indigo-600 mb-1",children:e.studentName}),(0,a.jsx)("p",{className:"text-[10px] font-bold text-gray-400 uppercase",children:(null==t?void 0:t.title)||"Devoir Inconnu"})]}),(0,a.jsx)("span",{className:"text-[9px] font-black text-gray-300 uppercase",children:new Date(e.date).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{e.file.startsWith("http")||e.file.startsWith("/")||e.file.startsWith("files/")?y.B.openPackFile(e.id,e.file):alert("Travail \xe9crit : \n\n".concat(e.file))},className:"flex-1 bg-gray-50 py-3 rounded-xl text-[10px] font-black uppercase flex items-center justify-center gap-2",children:[(0,a.jsx)(x.A,{size:14})," Voir le travail"]}),(0,a.jsx)("button",{onClick:()=>{var s;let t=prompt("Note (sur 20) :",(null==(s=e.score)?void 0:s.toString())||"");if(null!==t&&""!==t){let s=parseFloat(t);if(isNaN(s))return N.o.error("Note invalide");let a=prompt("Commentaire pour l'\xe9l\xe8ve :",e.feedback||"");y.B.updateSubmission({...e,score:s,feedback:a||void 0}),N.o.success("Note et commentaire envoy\xe9s !")}},className:(0,k.cn)("px-4 py-3 rounded-xl text-[10px] font-black uppercase flex-1 transition-all",void 0!==e.score?"bg-emerald-50 text-emerald-600 border border-emerald-100":"bg-indigo-600 text-white shadow-lg shadow-indigo-100"),children:void 0!==e.score?"Note: ".concat(e.score,"/20"):"Noter"})]}),e.feedback&&(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:[(0,a.jsx)("p",{className:"text-[8px] font-black uppercase text-gray-400 mb-1",children:"Votre commentaire :"}),(0,a.jsxs)("p",{className:"text-[10px] font-medium text-gray-600 italic",children:['"',e.feedback,'"']})]})]},s)}),0===z.length&&(0,a.jsx)("p",{className:"text-center py-20 text-[10px] font-bold text-gray-300 uppercase italic",children:"Aucun devoir rendu pour le moment"})]})]})]})]})}},85076:(e,s,t)=>{Promise.resolve().then(t.bind(t,75120))}},e=>{e.O(0,[727,720,760,497,258,441,493,358],()=>e(e.s=85076)),_N_E=e.O()}]);